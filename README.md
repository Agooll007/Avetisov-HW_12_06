# Домашнее задание к занятию «Репликация и масштабирование. Часть 1»

### Задание 1

На лекции рассматривались режимы репликации master-slave, master-master, опишите их различия.

*Ответить в свободной форме.*
 
 Master-Slave:
В этом режиме есть один сервер MASTER и один или несколько серверов SLAVE. Все изменения данных (INSERT, UPDATE, DELETE) выполняются только на MASTER, а SLAVE получают эти изменения и применяют их автоматически. SLAVE часто используются для резервного копирования или распределения нагрузки на чтение, чтобы разгрузить MASTER. Если MASTER выходит из строя, SLAVE может стать новым MASTER, но для этого требуется ручная или автоматическая перенастройка. Преимущество Master-Slave — простота настройки и надежность резервного копирования. Недостаток — ограничение на запись: данные можно изменять только на одном сервере.

Master-Master:
В этом режиме два или более серверов одновременно работают как MASTER друг для друга. Любой из серверов может принимать изменения данных, а они автоматически реплицируются на остальные мастера. Master-Master используется для высокой доступности и балансировки нагрузки на запись, особенно в географически распределённых системах. Преимущество — нет единственной точки отказа, можно писать на любой сервер. Недостатки — сложность настройки и возможные конфликты изменений, если одно и то же обновление произошло одновременно на двух серверах, поэтому требуется продуманная стратегия разрешения конфликтов.

### Задание 2

Выполните конфигурацию master-slave репликации, примером можно пользоваться из лекции.

*Приложите скриншоты конфигурации, выполнения работы: состояния и режимы работы серверов.*

#### На мастере:
```
#Правим конфиг
nano /etc/mysql/mysql.conf.d/mysqld.cnf
```
#Добавляем в конфигурацию
[mysqld]
server-id = 1
log_bin = mysql-bin
bind-address = 0.0.0.0
```
#Рестарт службы
sudo systemctl restart mysql
```
# Создаем пользователя и применяем 
CREATE USER 'repl'@'%' IDENTIFIED WITH mysql_native_password BY 'replpass';
GRANT REPLICATION SLAVE ON *.* TO 'repl'@'%';
FLUSH PRIVILEGES;
```
#Получаем бинарный лог 
SHOW MASTER STATUS;
```
[скриншот мастер]
```
#### На Slave:
```
#Правим конфиг
nano /etc/mysql/mysql.conf.d/mysqld.cnf
```
#Добавляем в конфигурацию
[mysqld]
server-id = 2
relay-log = mysql-relay-bin
read_only = 1
```
#Рестарт службы
sudo systemctl restart mysql
```
# Настройка репликации 

STOP SLAVE;

CHANGE MASTER TO
  MASTER_HOST='IP_MASTER',
  MASTER_USER='repl',
  MASTER_PASSWORD='replpass',
  MASTER_LOG_FILE='mysql-bin.000001',
  MASTER_LOG_POS=157;

START SLAVE;
```
#Проверка репликации 
SHOW SLAVE STATUS\G
```
[скриншот slave]


